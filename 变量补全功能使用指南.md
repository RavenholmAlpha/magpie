# 变量补全功能使用指南

## 🎉 好消息

变量自动补全功能已经在所有主要输入位置实现，包括：

## ✅ 支持变量补全的位置

### 1. URL 输入框
**位置：** 请求面板顶部
**使用方法：**
```
输入: {
弹出: 变量列表
选择: ↑↓ 键或鼠标点击
插入: Enter 或 Tab
```

**示例：**
```
输入: {
选择: baseUrl
结果: {{baseUrl}}

继续输入: {{baseUrl}}/api/{
选择: version
结果: {{baseUrl}}/api/{{version}}
```

### 2. Params（查询参数）✨
**位置：** Params 标签页
**使用方法：**
- 在**值（Value）列**输入 `{`
- 自动弹出变量列表
- 选择并插入变量

**示例：**
```
Key: limit
Value: { → 选择 pageSize → {{pageSize}}

Key: sort
Value: { → 选择 sortOrder → {{sortOrder}}
```

### 3. Headers（请求头）
**位置：** Headers 标签页
**使用方法：**
- 在**值（Value）列**输入 `{`
- 自动弹出变量列表

**示例：**
```
Key: Authorization
Value: Bearer { → 选择 token → Bearer {{token}}

Key: X-API-Key
Value: { → 选择 apiKey → {{apiKey}}
```

### 4. Body - Form Data
**位置：** Body 标签页 → Form Data
**使用方法：**
- 在**值（Value）列**输入 `{`
- 自动弹出变量列表

**示例：**
```
Key: user_id
Value: { → 选择 userId → {{userId}}
```

### 5. Body - URL Encoded
**位置：** Body 标签页 → URL Encoded
**使用方法：**
- 在**值（Value）列**输入 `{`
- 自动弹出变量列表

### 6. Auth - Bearer Token
**位置：** Auth 标签页 → Bearer Token
**使用方法：**
- 在 Token 输入框输入 `{`
- 自动弹出变量列表

**示例：**
```
Token: { → 选择 authToken → {{authToken}}
```

### 7. Auth - API Key
**位置：** Auth 标签页 → API Key
**使用方法：**
- 在 Value 输入框输入 `{`
- 自动弹出变量列表

## 🚀 快速开始

### 步骤 1：创建环境和变量

1. **点击左侧边栏的"管理"按钮**
2. **创建新环境**
   ```
   环境名称: 开发环境
   ```
3. **添加变量**
   ```
   baseUrl = https://api.example.com
   userId = 12345
   token = your-token-here
   pageSize = 20
   ```
4. **保存环境**

### 步骤 2：激活环境

在左侧边栏顶部的环境选择器中，选择刚创建的环境。

### 步骤 3：使用变量补全

#### 在 URL 中使用
```
1. 在 URL 输入框输入: {
2. 选择 baseUrl
3. 得到: {{baseUrl}}
4. 继续输入: {{baseUrl}}/users/{
5. 选择 userId
6. 最终: {{baseUrl}}/users/{{userId}}
```

#### 在 Params 中使用
```
1. 点击 Params 标签
2. 添加新参数
3. Key: limit
4. 在 Value 输入框输入: {
5. 选择 pageSize
6. 得到: {{pageSize}}
```

#### 在 Headers 中使用
```
1. 点击 Headers 标签
2. 添加新请求头
3. Key: Authorization
4. 在 Value 输入框输入: Bearer {
5. 选择 token
6. 得到: Bearer {{token}}
```

## 🎯 使用技巧

### 1. 键盘快捷键

| 按键 | 功能 |
|------|------|
| `{` | 触发变量补全 |
| `↑` | 向上选择 |
| `↓` | 向下选择 |
| `Enter` | 插入选中变量 |
| `Tab` | 插入选中变量 |
| `Esc` | 关闭补全列表 |

### 2. 多个变量组合

可以在同一个字段中使用多个变量：

**URL 示例：**
```
{{baseUrl}}/api/{{version}}/users/{{userId}}/posts/{{postId}}
```

**Header 示例：**
```
Bearer {{token}}-{{sessionId}}
```

**Param 示例：**
```
Key: search
Value: user:{{userId}} status:{{status}}
```

### 3. 变量显示

补全列表会显示：
- **变量名称**（如：baseUrl）
- **变量值**（如：https://api.example.com）
- **环境名称**（在标题栏显示）

### 4. 实时生效

变量在发送请求时自动替换：
```
请求前: {{baseUrl}}/users/{{userId}}
发送时: https://api.example.com/users/12345
```

## 📝 完整示例

### 场景：查询用户文章列表

**环境变量设置：**
```
baseUrl = https://jsonplaceholder.typicode.com
userId = 1
pageSize = 10
sortBy = created_at
```

**请求配置：**

1. **URL:**
   ```
   {{baseUrl}}/users/{{userId}}/posts
   ```

2. **Params:**
   ```
   limit: {{pageSize}}
   sort: {{sortBy}}
   ```

3. **Headers:**
   ```
   Content-Type: application/json
   X-User-ID: {{userId}}
   ```

4. **发送请求后实际 URL：**
   ```
   https://jsonplaceholder.typicode.com/users/1/posts?limit=10&sort=created_at
   ```

## ⚠️ 注意事项

### 1. 必须激活环境

- 只有激活环境后才能使用变量补全
- 在环境选择器中选择"无环境"时，不会显示补全列表

### 2. 变量必须启用

- 在环境管理中，只有**已启用**（打勾）的变量才会出现在补全列表中
- 禁用的变量不会显示

### 3. 变量格式

- 变量必须使用双花括号：`{{variableName}}`
- 不要手动输入双花括号，使用自动补全插入
- 正确格式：`{{token}}`
- 错误格式：`{token}` 或 `$token`

### 4. 只在值（Value）列有效

在 KeyValueEditor（Params、Headers、Form Data）中：
- ✅ **值（Value）列** - 支持变量补全
- ❌ **键（Key）列** - 不支持变量补全

### 5. JSON/Raw Body 暂不支持

目前在以下位置**不支持**变量补全：
- ❌ JSON Body（textarea）
- ❌ Raw Body（textarea）

这些位置可以手动输入 `{{variableName}}`，变量仍会被替换。

## 🐛 故障排查

### 问题：输入 `{` 没有弹出列表

**检查清单：**
1. ✓ 是否激活了环境？
   - 在左侧边栏查看环境选择器
   - 确保选择了一个环境，而不是"无环境"

2. ✓ 环境中是否有变量？
   - 打开环境管理
   - 确认至少有一个变量

3. ✓ 变量是否已启用？
   - 在环境管理中
   - 确认变量前面的复选框已勾选

4. ✓ 是否在正确的位置？
   - 确认在值（Value）列输入
   - 不是在键（Key）列

### 问题：变量没有被替换

**检查清单：**
1. ✓ 变量格式是否正确？
   - 应该是：`{{variableName}}`
   - 不是：`{variableName}` 或其他格式

2. ✓ 变量名是否正确？
   - 检查拼写
   - 区分大小写

3. ✓ 环境是否激活？
   - 发送请求时必须激活环境
   - 变量才会被替换

### 问题：补全列表位置不对

**可能原因：**
- 窗口大小调整导致
- 滚动位置变化

**解决方法：**
- 关闭并重新打开补全列表（按Esc后重新输入 `{`）
- 调整窗口大小

## 📊 功能覆盖

| 位置 | 支持补全 | 备注 |
|------|---------|------|
| URL 输入框 | ✅ | 完全支持 |
| Params - Value | ✅ | 完全支持 |
| Headers - Value | ✅ | 完全支持 |
| Form Data - Value | ✅ | 完全支持 |
| URL Encoded - Value | ✅ | 完全支持 |
| Bearer Token | ✅ | 完全支持 |
| API Key - Value | ✅ | 完全支持 |
| Basic Auth - Username | ❌ | 可手动输入 |
| Basic Auth - Password | ❌ | 可手动输入 |
| JSON Body | ❌ | 可手动输入 |
| Raw Body | ❌ | 可手动输入 |

## 💡 高级用法

### 1. 链式变量

创建一个变量引用另一个变量的值：

```
在环境中设置：
base = https://api.example.com
endpoint = {{base}}/users

在请求中使用：
URL: {{endpoint}}/{{userId}}
```

### 2. 默认值

在环境中为可选参数设置默认值：

```
环境变量：
pageSize = 20
orderBy = created_at

Params：
limit: {{pageSize}}
sort: {{orderBy}}
```

### 3. 多环境切换

为不同环境创建相同的变量名：

```
开发环境：
baseUrl = http://localhost:3000
token = dev-token

生产环境：
baseUrl = https://api.production.com
token = prod-token

请求配置保持不变：
URL: {{baseUrl}}/users
Header: Authorization: Bearer {{token}}

切换环境即可切换到不同的服务器！
```

## 🎓 学习视频（建议）

如果文字说明不够清楚，可以考虑添加：
1. GIF 动画演示
2. 视频教程
3. 交互式引导

## 📞 获取帮助

如果遇到问题：
1. 查看本文档的故障排查部分
2. 检查环境变量设置
3. 确认变量格式正确
4. 重启应用试试

---

## 总结

✅ **Params 已支持变量补全！**

只需：
1. 激活环境
2. 在 Params 的 Value 列输入 `{`
3. 选择变量
4. 完成！

现在就试试吧！🚀

